<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VisionFit</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="container">

    <h1>VisionFit</h1>
    <p>Lee cualquier web con mÃ¡xima comodidad visual</p>

    <!-- BUSCADOR -->
    <input id="urlInput" placeholder="Pega aquÃ­ un enlace web o escribe el nombre">
    <button onclick="openReader()">Abrir lector</button>

    <!-- CONTROLES ACCESIBILIDAD -->
    <div class="controls">
      <button onclick="increaseFont()">A+</button>
      <button onclick="decreaseFont()">A-</button>
      <button onclick="toggleDark()">ğŸŒ™</button>
      <button onclick="speak()">ğŸ”Š Leer</button>
      <button onclick="stopSpeech()">â¹ Parar</button>
      <button onclick="easySummary()">ğŸ§  Resumen fÃ¡cil</button>
      <button onclick="goBack()">â¬… Volver</button>
      <button onclick="goHome()">ğŸ  Inicio</button>
      <button onclick="saveArticle()">â­ Guardar</button>
      <button onclick="showFavorites()">ğŸ“š Favoritos</button>
    </div>

    <!-- CONTENIDO -->
    <div id="content">AquÃ­ aparecerÃ¡ la web</div>

    <hr>

    <!-- REGISTRO -->
    <h2>Registro VisionFit</h2>

    <input id="name" placeholder="Nombre">
    <input id="email" placeholder="Email">
    <input id="password" type="password" placeholder="ContraseÃ±a">

    <button onclick="register()">Registrarse</button>

  </div>

  <!-- SCRIPT -->
  <script>
    let fontSize = 18;
    let currentText = "";
    let historyStack = [];

    function openReader() {
      const url = document.getElementById("urlInput").value;
      historyStack.push(url);

      fetch("/api/reader", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ url })
      })
      .then(res => res.text())
      .then(html => {
        document.getElementById("content").innerHTML = html;
        currentText = document.getElementById("content").innerText;
      })
      .catch(() => {
        document.getElementById("content").innerHTML = "No se pudo extraer el contenido";
      });
    }

    function increaseFont() {
      fontSize += 2;
      document.getElementById("content").style.fontSize = fontSize + "px";
    }

    function decreaseFont() {
      fontSize -= 2;
      document.getElementById("content").style.fontSize = fontSize + "px";
    }

    function toggleDark() {
      document.body.classList.toggle("dark");
    }

    function speak() {
      const speech = new SpeechSynthesisUtterance(currentText);
      speech.lang = "es-ES";
      window.speechSynthesis.speak(speech);
    }

    function stopSpeech() {
      window.speechSynthesis.cancel();
    }

    function easySummary() {
      fetch("/api/summary", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text: currentText })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("content").innerHTML = "<h3>Resumen:</h3>" + data.summary;
      });
    }

    function goBack() {
      historyStack.pop();
      const previous = historyStack.pop();
      if (previous) {
        document.getElementById("urlInput").value = previous;
        openReader();
      }
    }

    function goHome() {
      document.getElementById("content").innerHTML = "AquÃ­ aparecerÃ¡ la web";
    }

    function saveArticle() {
      alert("FunciÃ³n guardado en desarrollo");
    }

    function showFavorites() {
      alert("Favoritos en desarrollo");
    }

    function register() {
      alert("Registro conectado con backend");
    }
  </script>

</body>
</html>